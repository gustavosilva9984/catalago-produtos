<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat√°logo de Produtos</title>
    <style>
        /* (Mantenha o CSS existente) */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            padding: 20px;
        }

        header {
            background-color: #555;
            color: #fff;
            text-align: center;
            padding: 20px;
            margin-bottom: 20px;
        }

        .filters {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }

        .filters button,
        .filters select {
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        .filters button:hover,
        .filters select:hover {
            background-color: #0056b3;
        }

        .filters select {
            padding: 8px;
        }

        .catalog-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        .card {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: 200px;
            height: 350px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s;
        }

        .card:hover {
            transform: scale(1.05);
        }

        .card img {
            height: 230px;
            object-fit: contain;
        }

        .card-content {
            padding: 15px;
            text-align: center;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .card h3 {
            font-size: 12px;
            color: #333;
            margin-bottom: 10px;
        }

        .card p {
            font-size: 8px;
            color: #3d3838;
            margin-bottom: 10px;

        }

        .card .product-code {
            font-weight: bold;
            color: #474040;
        }

        .card-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }

        .quantity-input {
            width: 50px;
            padding: 5px;
            text-align: center;
            font-weight: 700;
        }

        .add-to-cart-btn {
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .add-to-cart-btn:hover {
            background-color: #218838;
        }

        .cart-icon {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #007bff;
            color: #fff;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        .cart-icon:hover {
            background-color: #829cb8;
        }

        .cart-container {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100%;
            background-color: #fff;
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease-in-out;
            z-index: 1001;
            overflow-y: auto;
            padding: 20px;
        }

        .cart-container.open {
            right: 0;
        }

        .close-cart {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            font-size: 20px;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .order-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            text-decoration: none;
            transition: background-color 0.3s;
        }

        .order-button:hover {
            background-color: #218838;
        }

        /* Estilos espec√≠ficos para impress√£o */
        @media print {
    body{
        margin: 0;
        padding: 0;
    }

    header {
        display: none; /* Remove o cabe√ßalho da impress√£o */
    }

    .filters {
        display: none; /* Remove os filtros da impress√£o */
    }

    .catalog-container {
        display: grid;
        grid-template-columns: repeat(2, 1fr); /* 3 colunas */
        gap: 10px; /* Espa√ßamento entre os cards */
        flex-direction: row;
        margin: 0px;
    }

    .card {
        width: 100%; /* Ajusta a largura para caber na coluna */
        page-break-inside: avoid; /* Evita quebra de p√°gina dentro dos cards */
        height: 340px; /* Ajusta a altura dos cards automaticamente */
    }

    .card img {
        width: 100%; /* Ajusta a imagem para caber no card */
        height: 290PX; /* Mant√©m a propor√ß√£o da imagem */
    }

    .card h3 {
        font-size: 10px; /* Reduz o tamanho da fonte para impress√£o */
        font-style: italic;
        color: #070707;
    }

    .quantity-input {
        display: none;
    }

    .add-to-cart-btn {
        display: none;
    }

    .show-description-btn {
        display: none;
    }

    .cart-icon {
        display: none;
    }

    .card .product-code {
        color: #8f0505;
        font-size: 12px;
        margin-bottom: 3px;
    }
}



        .vendor-select {
            margin: 20px 0;
        }

        .vendor-select select {
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        .vendor-select select:hover {
            background-color: #0056b3;
        }

        .send-message-btn {
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            text-decoration: none;
            transition: background-color 0.3s;
        }

        .send-message-btn:hover {
            background-color: #218838;
        }

        #search-input{
            width: 200px;
            height: 30px;
            color: #070707;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 12px;
        }
        .print-container {
    text-align: center;
    margin-bottom: 20px;
}

.print-btn {
    background-color: #17a2b8;
    color: #fff;
    border: none;
    border-radius: 5px;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s;
}

.print-btn:hover {
    background-color: #138496;
}
.description-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2000;
}

.description-content {
    background: #fff;
    border-radius: 10px;
    padding: 20px;
    width: 80%;
    max-width: 600px;
    position: relative;
}

.description-content h3 {
    margin-bottom: 10px;
}

.description-content .close-description {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
    font-size: 20px;
}

.card .show-description-btn {
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 5px;
    padding: 5px 10px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s;
}

.card .show-description-btn:hover {
    background-color: #0056b3;
}
/* Estilo para o cont√™iner de descri√ß√£o */
#description-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2000;
}

.description-content {
    background: #fff;
    border-radius: 10px;
    padding: 20px;
    width: 80%;
    max-width: 600px;
    position: relative;
}

.close-description {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
    font-size: 20px;
    color: #333;
}

    </style>
</head>
<body>
    <header>
        <h1>Cat√°logo de Produtos</h1>
        <div class="print-container">
            <button id="print-btn" class="print-btn">Imprimir</button>
        </div>
        
    </header>

    <div class="filters" id="filters">
        <button id="show-all">Todos</button>
        <input type="text" id="search-input" placeholder="Buscar por nome ou c√≥digo" />
        <select id="category-select">
            <option value="">Escolha uma categoria</option>
        </select>
        <select id="subcategory-select" style="display: none;">
            <option value="">Escolha uma subcategoria</option>
        </select>
    </div>

    <div class="catalog-container" id="catalog-container">
        <!-- Os cards de produtos ser√£o gerados dinamicamente aqui -->
    </div>

    <div class="cart-icon" id="cart-icon">üõí</div>

    <div class="cart-container" id="cart-container">
        <div class="close-cart" id="close-cart">√ó</div>
        <h2>Carrinho de Compras</h2>
        <div id="cart-items"></div>
        <div class="cart-footer">
            <div class="vendor-select">
                <select id="vendor-select">
                    <option value="">Escolha um vendedor</option>
                </select>
            </div>
            <button class="send-message-btn" id="send-message-btn">Enviar Mensagem</button>
        </div>
    </div>
    <div id="description-modal" class="description-overlay" style="display: none;">
        <div class="description-content">
            <span class="close-description" id="close-description">√ó</span>
            <h3 id="description-title">T√≠tulo</h3>
            <p id="description-text">Descri√ß√£o</p>
        </div>
    </div>
    
    <script>
        const sheetId = '1mJbjNBsfJQmhThpFvaYchuvNslHtRBPWiV7fgzONJl8';
        const apiKey = 'AIzaSyBUBfQAzykuAOrdQzJHR_RTVzK0R5HhFrM';
        const sheetName = 'Pagina1';
        
        const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetName}?key=${apiKey}`;
        
        fetch(url)
            .then(response => response.json())
            .then(data => {
                const headers = data.values[0];
                const products = data.values.slice(1);
                const catalogContainer = document.getElementById('catalog-container');
                const categorySelect = document.getElementById('category-select');
                const subcategorySelect = document.getElementById('subcategory-select');
                const vendorSelect = document.getElementById('vendor-select');
                const sendMessageBtn = document.getElementById('send-message-btn');
                const searchInput = document.getElementById('search-input');
        
                const headerIndex = {
                    nome: headers.indexOf('nome'),
                    codigo: headers.indexOf('codigo'),
                    img: headers.indexOf('img'),
                    categoria: headers.indexOf('categoria'),
                    subcategoria: headers.indexOf('subcategoria'),
                    descricao: headers.indexOf('descricao')
                };
        
                if (Object.values(headerIndex).includes(-1)) {
                    console.error('Uma ou mais colunas necess√°rias n√£o foram encontradas na planilha.');
                    return;
                }
        
                const vendors = [
                    { name: 'GUSTAVO', whatsapp: '+55038998853882' },
                    { name: 'GABRIEL', whatsapp: '+55038997299051' },
                ];
        
                vendors.forEach(vendor => {
                    const option = document.createElement('option');
                    option.value = vendor.whatsapp;
                    option.textContent = vendor.name;
                    vendorSelect.appendChild(option);
                });
        
                const categories = new Set();
                const subcategories = new Map();
        
                products.forEach(product => {
                    const category = product[headerIndex.categoria];
                    const subcategory = product[headerIndex.subcategoria];
        
                    categories.add(category);
                    if (category && subcategory) {
                        if (!subcategories.has(category)) {
                            subcategories.set(category, new Set());
                        }
                        subcategories.get(category).add(subcategory);
                    }
                });
        
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categorySelect.appendChild(option);
                });
        
                const allOption = document.createElement('option');
                allOption.value = '';
                allOption.textContent = 'Todas as subcategorias';
                subcategorySelect.appendChild(allOption);
        
                function updateSubcategories() {
                    const selectedCategory = categorySelect.value;
                    subcategorySelect.innerHTML = '<option value="">Escolha uma subcategoria</option>';
        
                    if (selectedCategory) {
                        const subcategoriesForCategory = subcategories.get(selectedCategory);
                        if (subcategoriesForCategory) {
                            subcategoriesForCategory.forEach(subcategory => {
                                const option = document.createElement('option');
                                option.value = subcategory;
                                option.textContent = subcategory;
                                subcategorySelect.appendChild(option);
                            });
                        }
                        subcategorySelect.style.display = 'block';
                    } else {
                        subcategorySelect.style.display = 'none';
                    }
                }
        
                function filterProducts() {
                    const selectedCategory = categorySelect.value;
                    const selectedSubcategory = subcategorySelect.value;
                    const searchTerm = searchInput.value.toLowerCase();
        
                    const filteredProducts = products.filter(product => {
                        const productCategory = product[headerIndex.categoria];
                        const productSubcategory = product[headerIndex.subcategoria];
                        const productName = product[headerIndex.nome].toLowerCase();
                        const productCode = product[headerIndex.codigo].toLowerCase();
        
                        return (selectedCategory === '' || productCategory === selectedCategory) &&
                               (selectedSubcategory === '' || productSubcategory === selectedSubcategory) &&
                               (productName.includes(searchTerm) || productCode.includes(searchTerm));
                    });
        
                    displayProducts(filteredProducts);
                }
        
                function displayProducts(productsToDisplay) {
                    catalogContainer.innerHTML = '';
                    productsToDisplay.forEach(product => {
                        const nome = product[headerIndex.nome];
                        const codigo = product[headerIndex.codigo];
                        const img = product[headerIndex.img];
                        const descricao = product[headerIndex.descricao] || 'Descri√ß√£o n√£o dispon√≠vel';
        
                        const card = document.createElement('div');
                        card.className = 'card';
        
                        card.innerHTML = `
                            <img src="${img}" alt="${nome}" class="product-image" style="cursor: pointer;">
                            <div class="card-content">
                                <h3>${nome}</h3>
                                <p class="product-code">C√≥digo: ${codigo}</p>
                                <div class="card-actions">
                                    <input type="number" class="quantity-input" value="1" min="1">
                                    <button class="add-to-cart-btn" data-product='${JSON.stringify(product)}'>Adicionar</button>
                                    <button class="show-description-btn" data-description='${descricao}'>+</button>
                                </div>
                            </div>
                        `;
        
                        catalogContainer.appendChild(card);
        
                        card.querySelector('.product-image').addEventListener('click', () => {
                            enlargeImage(img);
                        });
        
                        card.querySelector('.show-description-btn').addEventListener('click', () => {
                            showDescription(descricao, nome);
                        });
        
                        card.querySelector('.add-to-cart-btn').addEventListener('click', addToCart);
                    });
                }
        
                function enlargeImage(src) {
                    const modal = document.createElement('div');
                    modal.style.position = 'fixed';
                    modal.style.top = 0;
                    modal.style.left = 0;
                    modal.style.width = '100%';
                    modal.style.height = '100%';
                    modal.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
                    modal.style.display = 'flex';
                    modal.style.alignItems = 'center';
                    modal.style.justifyContent = 'center';
                    modal.style.zIndex = 1000;
        
                    const img = document.createElement('img');
                    img.src = src;
                    img.style.maxWidth = '90%';
                    img.style.maxHeight = '90%';
        
                    modal.appendChild(img);
                    document.body.appendChild(modal);
        
                    modal.addEventListener('click', () => {
                        document.body.removeChild(modal);
                    });
                }
        
                const cart = [];
        
                function addToCart(event) {
                    const product = JSON.parse(event.target.getAttribute('data-product'));
                    const quantity = parseInt(event.target.previousElementSibling.value);
        
                    const existingItem = cart.find(item => item.product[headerIndex.codigo] === product[headerIndex.codigo]);
        
                    if (existingItem) {
                        existingItem.quantity += quantity;
                    } else {
                        cart.push({ product, quantity });
                    }
        
                    updateCartDisplay();
                }
        
                function updateCartDisplay() {
                    const cartItems = document.getElementById('cart-items');
                    cartItems.innerHTML = '';
        
                    cart.forEach(item => {
                        const cartItem = document.createElement('div');
                        cartItem.className = 'cart-item';
                        cartItem.innerHTML = `
                            <span>${item.product[headerIndex.nome]} (${item.quantity})</span>
                            <button class="remove-item" data-code="${item.product[headerIndex.codigo]}">Remover</button>
                        `;
                        cartItems.appendChild(cartItem);
                    });
        
                    document.querySelectorAll('.remove-item').forEach(button => {
                        button.addEventListener('click', removeFromCart);
                    });
                }
        
                function removeFromCart(event) {
                    const codeToRemove = event.target.getAttribute('data-code');
                    cart = cart.filter(item => item.product[headerIndex.codigo] !== codeToRemove);
                    updateCartDisplay();
                }
        
                const cartIcon = document.getElementById('cart-icon');
                const cartContainer = document.getElementById('cart-container');
                const closeCart = document.getElementById('close-cart');
        
                cartIcon.addEventListener('click', () => {
                    cartContainer.classList.add('open');
                });
        
                closeCart.addEventListener('click', () => {
                    cartContainer.classList.remove('open');
                });
        
                const showAllButton = document.getElementById('show-all');
                showAllButton.addEventListener('click', () => {
                    categorySelect.value = '';
                    subcategorySelect.value = '';
                    subcategorySelect.style.display = 'none';
                    searchInput.value = '';
                    displayProducts(products);
                });
        
                function sendMessage() {
                    const selectedVendor = vendorSelect.value;
        
                    if (!selectedVendor) {
                        alert('Por favor, escolha um vendedor.');
                        return;
                    }
        
                    if (cart.length === 0) {
                        alert('O carrinho est√° vazio.');
                        return;
                    }
        
                    let message = 'Ol√°, gostaria de fazer um pedido:\n\n';
                    cart.forEach(item => {
                        message += `‚Ä¢(C√≥digo: ${item.product[headerIndex.codigo]}) - Quantidade: ${item.quantity}\n`;
                    });
        
                    const encodedMessage = encodeURIComponent(message);
                    const whatsappUrl = `https://api.whatsapp.com/send?phone=${selectedVendor}&text=${encodedMessage}`;
        
                    window.open(whatsappUrl, '_blank');
                }
        
                sendMessageBtn.addEventListener('click', sendMessage);
        
                searchInput.addEventListener('input', filterProducts);
                categorySelect.addEventListener('change', () => {
                    updateSubcategories();
                    filterProducts();
                });
                subcategorySelect.addEventListener('change', filterProducts);
        
                displayProducts(products);
            })
            .catch(error => console.error('Erro ao buscar dados da planilha:', error));
        
        document.getElementById('print-btn').addEventListener('click', () => {
            window.print();
        });
        
        function showDescription(descricao, nome) {
            document.getElementById('description-title').textContent = nome;
            document.getElementById('description-text').textContent = descricao;
            document.getElementById('description-modal').style.display = 'flex';
        }
        
        function closeDescription() {
            document.getElementById('description-modal').style.display = 'none';
        }
        
        document.getElementById('close-description').addEventListener('click', closeDescription);
        </script>
        
        
</body>
</html>
